<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mock Data Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        h1, h2 {
            color: #333;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        textarea {
            width: 100%;
            height: 200px;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-family: monospace;
        }
        button {
            background-color: #4CAF50;
            color: white;
            padding: 10px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin-right: 10px;
        }
        button:hover {
            background-color: #45a049;
        }
        #result {
            margin-top: 20px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 4px;
            background-color: #f9f9f9;
            white-space: pre-wrap;
            max-height: 400px;
            overflow-y: auto;
        }
        .status {
            padding: 10px;
            margin-top: 10px;
            border-radius: 4px;
        }
        .success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .info {
            background-color: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        .tab {
            overflow: hidden;
            border: 1px solid #ccc;
            background-color: #f1f1f1;
            border-radius: 4px 4px 0 0;
        }
        .tab button {
            background-color: inherit;
            float: left;
            border: none;
            outline: none;
            cursor: pointer;
            padding: 10px 16px;
            transition: 0.3s;
            color: #333;
        }
        .tab button:hover {
            background-color: #ddd;
        }
        .tab button.active {
            background-color: #4CAF50;
            color: white;
        }
        .tabcontent {
            display: none;
            padding: 15px;
            border: 1px solid #ccc;
            border-top: none;
            border-radius: 0 0 4px 4px;
        }
        .visible {
            display: block;
        }
    </style>
</head>
<body>
    <h1>Mock Data Test</h1>
    
    <div class="form-group">
        <label for="mock-data">Mock PDF Data (JSON):</label>
        <textarea id="mock-data">
{
  "name": "Test Portfolio Statement",
  "type": "financial_statement",
  "content": {
    "text": "INVESTMENT PORTFOLIO STATEMENT\n\nDate: 28.02.2025\nAccount Number: 12345678\nClient: John Doe\n\nPORTFOLIO SUMMARY\nTotal Value: USD 1,250,000.00\nCurrency: USD\nValuation Date: 28.02.2025\n\nASSET ALLOCATION\nEquity: 45%\nFixed Income: 30%\nCash: 15%\nAlternative: 10%\n\nSECURITIES HOLDINGS\nAPPLE INC (US0378331005) - Equity - 500 - USD 170.00 - USD 85,000.00 - 6.8%\nMICROSOFT CORP (US5949181045) - Equity - 300 - USD 340.00 - USD 102,000.00 - 8.16%\nAMAZON.COM INC (US0231351067) - Equity - 100 - USD 950.00 - USD 95,000.00 - 7.6%\nUS TREASURY 2.5% 15/02/2045 (US912810RK35) - Bond - 200,000 - USD 0.99 - USD 198,000.00 - 15.84%\nGOLDMAN SACHS 0% NOTES 23-07.11.29 (XS2692298537) - Bond - 150,000 - USD 0.98 - USD 147,000.00 - 11.76%\n\nSECTOR ALLOCATION\nTechnology: 22.56%\nConsumer: 7.6%\nGovernment: 15.84%\nFinancial: 11.76%\nOther: 42.24%\n\nNOTES\nThis portfolio statement is for informational purposes only and does not constitute investment advice. Past performance is not indicative of future results. Please consult with your financial advisor before making any investment decisions.",
    "tables": [
      {
        "title": "Asset Allocation",
        "headers": ["Asset Class", "Percentage"],
        "rows": [
          ["Equity", "45%"],
          ["Fixed Income", "30%"],
          ["Cash", "15%"],
          ["Alternative", "10%"]
        ]
      },
      {
        "title": "Securities Holdings",
        "headers": ["Security", "ISIN", "Type", "Quantity", "Price", "Value", "Weight"],
        "rows": [
          ["APPLE INC", "US0378331005", "Equity", "500", "USD 170.00", "USD 85,000.00", "6.8%"],
          ["MICROSOFT CORP", "US5949181045", "Equity", "300", "USD 340.00", "USD 102,000.00", "8.16%"],
          ["AMAZON.COM INC", "US0231351067", "Equity", "100", "USD 950.00", "USD 95,000.00", "7.6%"],
          ["US TREASURY 2.5% 15/02/2045", "US912810RK35", "Bond", "200,000", "USD 0.99", "USD 198,000.00", "15.84%"],
          ["GOLDMAN SACHS 0% NOTES 23-07.11.29", "XS2692298537", "Bond", "150,000", "USD 0.98", "USD 147,000.00", "11.76%"]
        ]
      },
      {
        "title": "Sector Allocation",
        "headers": ["Sector", "Percentage"],
        "rows": [
          ["Technology", "22.56%"],
          ["Consumer", "7.6%"],
          ["Government", "15.84%"],
          ["Financial", "11.76%"],
          ["Other", "42.24%"]
        ]
      }
    ]
  },
  "metadata": {
    "title": "Investment Portfolio Statement",
    "author": "Financial Institution",
    "creationDate": "2025-02-28",
    "securities": [
      {
        "name": "APPLE INC",
        "isin": "US0378331005",
        "type": "Equity",
        "quantity": 500,
        "price": 170.00,
        "value": 85000.00,
        "currency": "USD",
        "weight": 0.068
      },
      {
        "name": "MICROSOFT CORP",
        "isin": "US5949181045",
        "type": "Equity",
        "quantity": 300,
        "price": 340.00,
        "value": 102000.00,
        "currency": "USD",
        "weight": 0.0816
      },
      {
        "name": "AMAZON.COM INC",
        "isin": "US0231351067",
        "type": "Equity",
        "quantity": 100,
        "price": 950.00,
        "value": 95000.00,
        "currency": "USD",
        "weight": 0.076
      },
      {
        "name": "US TREASURY 2.5% 15/02/2045",
        "isin": "US912810RK35",
        "type": "Bond",
        "quantity": 200000,
        "price": 0.99,
        "value": 198000.00,
        "currency": "USD",
        "weight": 0.1584
      },
      {
        "name": "GOLDMAN SACHS 0% NOTES 23-07.11.29",
        "isin": "XS2692298537",
        "type": "Bond",
        "quantity": 150000,
        "price": 0.98,
        "value": 147000.00,
        "currency": "USD",
        "weight": 0.1176
      }
    ],
    "portfolio": {
      "totalValue": 1250000.00,
      "currency": "USD",
      "valuationDate": "2025-02-28",
      "assetAllocation": {
        "equity": 0.45,
        "fixedIncome": 0.30,
        "cash": 0.15,
        "alternative": 0.10
      },
      "sectorAllocation": {
        "technology": 0.2256,
        "consumer": 0.076,
        "government": 0.1584,
        "financial": 0.1176,
        "other": 0.4224
      }
    }
  }
}
        </textarea>
    </div>
    
    <div class="form-group">
        <label for="questions">Questions (one per line):</label>
        <textarea id="questions">What is the total value of the portfolio?
How many securities are in the portfolio?
What is the ISIN of Apple Inc?
What is the weight of Microsoft Corp in the portfolio?
What is the asset allocation of the portfolio?</textarea>
    </div>
    
    <button id="process-btn">Process Mock Data</button>
    
    <div id="result-container" style="display: none; margin-top: 20px;">
        <div class="tab">
            <button class="tablink active" onclick="openTab(event, 'result-json')">JSON Result</button>
            <button class="tablink" onclick="openTab(event, 'result-text')">Extracted Text</button>
            <button class="tablink" onclick="openTab(event, 'result-tables')">Tables</button>
            <button class="tablink" onclick="openTab(event, 'result-securities')">Securities</button>
            <button class="tablink" onclick="openTab(event, 'result-qa')">Q&A</button>
        </div>
        
        <div id="result-json" class="tabcontent visible"></div>
        <div id="result-text" class="tabcontent"></div>
        <div id="result-tables" class="tabcontent"></div>
        <div id="result-securities" class="tabcontent"></div>
        <div id="result-qa" class="tabcontent"></div>
    </div>
    
    <script>
        // Open tab function
        function openTab(evt, tabName) {
            // Hide all tab content
            const tabcontent = document.getElementsByClassName("tabcontent");
            for (let i = 0; i < tabcontent.length; i++) {
                tabcontent[i].classList.remove("visible");
            }
            
            // Remove active class from all tab links
            const tablinks = document.getElementsByClassName("tablink");
            for (let i = 0; i < tablinks.length; i++) {
                tablinks[i].classList.remove("active");
            }
            
            // Show the current tab and add active class to the button
            document.getElementById(tabName).classList.add("visible");
            evt.currentTarget.classList.add("active");
        }
        
        // Process button click handler
        document.getElementById('process-btn').addEventListener('click', () => {
            const mockDataText = document.getElementById('mock-data').value;
            const questionsText = document.getElementById('questions').value;
            const resultContainer = document.getElementById('result-container');
            
            try {
                // Parse mock data
                const mockData = JSON.parse(mockDataText);
                
                // Parse questions
                const questions = questionsText.split('\n').filter(q => q.trim() !== '');
                
                // Display JSON result
                document.getElementById('result-json').innerHTML = `<pre>${JSON.stringify(mockData, null, 2)}</pre>`;
                
                // Display extracted text
                let extractedText = '';
                if (mockData.content && mockData.content.text) {
                    extractedText = mockData.content.text;
                }
                document.getElementById('result-text').innerHTML = `<pre>${extractedText}</pre>`;
                
                // Display tables
                let tablesHtml = '';
                if (mockData.content && mockData.content.tables && mockData.content.tables.length > 0) {
                    tablesHtml = '<h3>Extracted Tables</h3>';
                    mockData.content.tables.forEach((table, index) => {
                        tablesHtml += `<h4>${table.title || `Table ${index + 1}`}</h4>`;
                        tablesHtml += '<table border="1" cellpadding="5" style="border-collapse: collapse;">';
                        
                        // Add headers if available
                        if (table.headers && table.headers.length > 0) {
                            tablesHtml += '<tr>';
                            table.headers.forEach(header => {
                                tablesHtml += `<th>${header}</th>`;
                            });
                            tablesHtml += '</tr>';
                        }
                        
                        // Add rows
                        if (table.rows && table.rows.length > 0) {
                            table.rows.forEach(row => {
                                tablesHtml += '<tr>';
                                row.forEach(cell => {
                                    tablesHtml += `<td>${cell}</td>`;
                                });
                                tablesHtml += '</tr>';
                            });
                        }
                        
                        tablesHtml += '</table>';
                    });
                } else {
                    tablesHtml = '<p>No tables extracted</p>';
                }
                document.getElementById('result-tables').innerHTML = tablesHtml;
                
                // Display securities
                let securitiesHtml = '';
                if (mockData.metadata && mockData.metadata.securities && mockData.metadata.securities.length > 0) {
                    securitiesHtml = '<h3>Extracted Securities</h3>';
                    securitiesHtml += '<table border="1" cellpadding="5" style="border-collapse: collapse;">';
                    securitiesHtml += '<tr><th>Name</th><th>ISIN</th><th>Type</th><th>Quantity</th><th>Value</th><th>Weight</th></tr>';
                    
                    mockData.metadata.securities.forEach(security => {
                        securitiesHtml += '<tr>';
                        securitiesHtml += `<td>${security.name || '-'}</td>`;
                        securitiesHtml += `<td>${security.isin || '-'}</td>`;
                        securitiesHtml += `<td>${security.type || '-'}</td>`;
                        securitiesHtml += `<td>${security.quantity || '-'}</td>`;
                        securitiesHtml += `<td>${security.value ? `${security.currency} ${security.value.toFixed(2)}` : '-'}</td>`;
                        securitiesHtml += `<td>${security.weight ? `${(security.weight * 100).toFixed(2)}%` : '-'}</td>`;
                        securitiesHtml += '</tr>';
                    });
                    
                    securitiesHtml += '</table>';
                } else {
                    securitiesHtml = '<p>No securities extracted</p>';
                }
                document.getElementById('result-securities').innerHTML = securitiesHtml;
                
                // Generate Q&A
                let qaHtml = '<h3>Questions & Answers</h3>';
                
                // Function to answer questions based on mock data
                function answerQuestion(question) {
                    const q = question.toLowerCase();
                    
                    if (q.includes('total value') || q.includes('portfolio value')) {
                        return `The total value of the portfolio is ${mockData.metadata.portfolio.currency} ${mockData.metadata.portfolio.totalValue.toFixed(2)}.`;
                    } else if (q.includes('how many securities') || q.includes('number of securities')) {
                        return `There are ${mockData.metadata.securities.length} securities in the portfolio.`;
                    } else if (q.includes('isin') && q.includes('apple')) {
                        const apple = mockData.metadata.securities.find(s => s.name.toLowerCase().includes('apple'));
                        return apple ? `The ISIN of Apple Inc is ${apple.isin}.` : 'Apple Inc was not found in the portfolio.';
                    } else if (q.includes('weight') && q.includes('microsoft')) {
                        const microsoft = mockData.metadata.securities.find(s => s.name.toLowerCase().includes('microsoft'));
                        return microsoft ? `The weight of Microsoft Corp in the portfolio is ${(microsoft.weight * 100).toFixed(2)}%.` : 'Microsoft Corp was not found in the portfolio.';
                    } else if (q.includes('asset allocation')) {
                        const allocation = mockData.metadata.portfolio.assetAllocation;
                        return `The asset allocation of the portfolio is: Equity ${(allocation.equity * 100).toFixed(0)}%, Fixed Income ${(allocation.fixedIncome * 100).toFixed(0)}%, Cash ${(allocation.cash * 100).toFixed(0)}%, and Alternative ${(allocation.alternative * 100).toFixed(0)}%.`;
                    } else {
                        return 'I don\'t have enough information to answer this question.';
                    }
                }
                
                questions.forEach(question => {
                    const answer = answerQuestion(question);
                    
                    qaHtml += `<div style="margin-bottom: 15px;">
                        <p><strong>Q: ${question}</strong></p>
                        <p>${answer}</p>
                    </div>`;
                });
                
                document.getElementById('result-qa').innerHTML = qaHtml;
                
                // Show results
                resultContainer.style.display = 'block';
            } catch (error) {
                console.error('Error:', error);
                alert(`Error: ${error.message}`);
            }
        });
    </script>
</body>
</html>
